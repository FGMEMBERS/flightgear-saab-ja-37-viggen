<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="http://jsbsim.sourceforge.net/JSBSim.xsl"?>
<fdm_config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" name="Saab JA-37 Viggen" version="2.0" release="ALPHA" xsi:noNamespaceSchemaLocation="http://jsbsim.sourceforge.net/JSBSim.xsd">
  <fileheader>
    <author> Necolatis (Aeromatic v 0.95) / DATCOM </author>
    <filecreationdate> 2013-02-15 </filecreationdate>
    <version> 1.11 </version>
    <license>
      <licenseName>GPL (General Public License)</licenseName>
      <licenseURL>http://www.gnu.org/licenses/gpl.html</licenseURL>
    </license>
    <description> Models a Saab JA-37 Viggen </description>
    <note>
         This model was created using data that is, or has been, publically
         available by means of technical reports, textbooks, image graphs or
         published code. This aircraft description file is in no way related 
         to the manufacturer of the real aircraft.
         Neither the name of (any of) the authors nor the names of (any of) the
         manufacturers may be used to endorse or promote products derived from
         this file.
 
         The data is provided ''as is'' and any express or implied
         warranties, including, but not limitted to the implied warranties of
         merchantability and fitness for a particular purpose are disclaimed.
         
         Many nice things taken from F16, Buccaneer, 747-400 and Mig-15 plus some more I forgot.
      </note>
  </fileheader>
  


 <metrics>
   <wingarea unit="FT2">      179.4182  </wingarea>
      <wingspan unit="FT">        19.3570  </wingspan>
      <chord unit="FT">           11.0136  </chord>
      <htailarea unit="FT2">     562.4756  </htailarea>
      <htailarm unit="FT">        17.4042  </htailarm>
      <vtailarea unit="FT2">     106.9664  </vtailarea>
      <vtailarm unit="FT">        21.7358  </vtailarm>
    <location name="AERORP" unit="M">
      <x> 0.9 </x>
      <y> -0 </y>
      <z> -0.25 </z>
    </location>
    <location name="EYEPOINT" unit="M">
      <x> -13.61 </x>
      <y> 0 </y>
      <z> 0.55 </z>
    </location>
    <location name="VRP" unit="IN">
      <x> 0 </x>
      <y> 0 </y>
      <z> 0 </z>
    </location>
  </metrics>
  
  <mass_balance>
    <ixx unit="SLUG*FT2">     18037 </ixx>
   <iyy unit="SLUG*FT2">     69502 </iyy>
   <izz unit="SLUG*FT2">     62565 </izz>
   <emptywt unit="LBS" >     26015 </emptywt>
    <location name="CG" unit="M">
      <x> 1 </x>
      <!--  -->
      <y> 0 </y>
      <z> 0 </z>
    </location>
    <pointmass name="Pilot">
      <weight unit="LBS"> 230 </weight>
      <location name="POINTMASS" unit="M">
        <x> -3.7 </x>
        <y> 0 </y>
        <z> 0 </z>
      </location>
    </pointmass>
  </mass_balance>
  
  <ground_reactions>
    <contact type="BOGEY" name="NOSE_LG">
      <location unit="M">
        <x> -3.4 </x>
        <y> 0 </y>
        <z> -2.1 </z>
      </location>
      <static_friction> 0.8 </static_friction>
      <dynamic_friction> 0.5 </dynamic_friction>
      <rolling_friction> 0.02 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 25000 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 4250 </damping_coeff>
      <max_steer unit="DEG"> 80 </max_steer>
      <brake_group> NOSE </brake_group>
      <retractable>1</retractable>
    </contact>
    <contact type="BOGEY" name="LEFT_MLG">
      <location unit="M">
        <x> 2.4 </x>
        <y> -2.5 </y>
        <z> -2.1 </z>
      </location>
      <static_friction> 0.8 </static_friction>
      <dynamic_friction> 0.5 </dynamic_friction>
      <rolling_friction> 0.02 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 37500 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 7500 </damping_coeff>
      <max_steer unit="DEG"> 0.0 </max_steer>
      <brake_group> LEFT </brake_group>
      <retractable>1</retractable>
    </contact>
    <contact type="BOGEY" name="RIGHT_MLG">
      <location unit="M">
        <x> 2.4 </x>
        <y> 2.5 </y>
        <z> -2.1 </z>
      </location>
      <static_friction> 0.8 </static_friction>
      <dynamic_friction> 0.5 </dynamic_friction>
      <rolling_friction> 0.02 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 37500 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 7500 </damping_coeff>
      <max_steer unit="DEG"> 0.0 </max_steer>
      <brake_group> RIGHT </brake_group>
      <retractable>1</retractable>
    </contact>
    <contact type="STRUCTURE" name="LEFT_WT">
      <location unit="M">
        <x> 6.43 </x>
        <y> 5.6 </y>
        <z> 0 </z>
      </location>
      <static_friction> 1.2 </static_friction>
      <dynamic_friction> 1.2 </dynamic_friction>
      <rolling_friction> 1.2 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 10000 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 2000 </damping_coeff>
    </contact>
    <contact type="STRUCTURE" name="RIGHT_WT">
      <location unit="M">
        <x> 6.43 </x>
        <y> -5.6 </y>
        <z> 0 </z>
      </location>
      <static_friction> 1.2 </static_friction>
      <dynamic_friction> 1.2 </dynamic_friction>
      <rolling_friction> 1.2 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 10000 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 2000 </damping_coeff>
    </contact>
    <contact type="STRUCTURE" name="TOP_VT">
      <location unit="M">
        <x> 6.0 </x>
        <y> 0 </y>
        <z> 3.9 </z>
      </location>
      <static_friction> 1.2 </static_friction>
      <dynamic_friction> 1.2 </dynamic_friction>
      <rolling_friction> 1.2 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 10000 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 2000 </damping_coeff>
    </contact>
    <contact type="STRUCTURE" name="RADARDOME">
      <location unit="M">
        <x> -7.75 </x>
        <y> 0 </y>
        <z> -0.82 </z>
      </location>
      <static_friction> 2.2 </static_friction>
      <dynamic_friction> 2.2 </dynamic_friction>
      <rolling_friction> 2.2 </rolling_friction>
      <spring_coeff unit="LBS/FT"> 10000 </spring_coeff>
      <damping_coeff unit="LBS/FT/SEC"> 2000 </damping_coeff>
    </contact>
  </ground_reactions>
  
  <propulsion>
    <engine file="RM8B">
      <location unit="M">
        <x> -3.21 </x>
        <y> 0 </y>
        <z> 0 </z>
      </location>
      <orient unit="DEG">
        <roll> 0.0 </roll>
        <pitch> 0 </pitch>
        <yaw> 0 </yaw>
      </orient>
      <feed>0</feed>
      <feed>1</feed>
      <feed>2</feed>
      <feed>3</feed>
      <thruster file="direct">
        <location unit="M">
          <x> 7.8 </x>
          <y> 0 </y>
          <z> 0 </z>
        </location>
        <orient unit="DEG">
          <roll> 0.0 </roll>
          <pitch> 0.0 </pitch>
          <yaw> 0.0 </yaw>
        </orient>
      </thruster>
    </engine>
    
    <tank type="FUEL">
      <!-- Fuselage Main Tank 1 -->
      <location unit="M">
        <x> 1 </x>
        <y> 0 </y>
        <z> 0.4 </z>
      </location>
      <capacity unit="KG"> 4700 </capacity>
      <contents unit="KG"> 4700 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Fuselage Forward Tank 2 -->
      <location unit="M">
        <x> -1.75 </x>
        <y> 0 </y>
        <z> 0.4 </z>
      </location>
      <capacity unit="KG"> 2350 </capacity>
      <contents unit="KG"> 2350 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Left Fuselage Minor Tank 3V -->
      <location unit="M">
        <x> -0.4 </x>
        <y> -0.65 </y>
        <z> 0.4 </z>
      </location>
      <capacity unit="KG"> 295 </capacity>
      <contents unit="KG"> 0 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Right Fuselage Minor Tank 3H -->
      <location unit="M">
        <x> -0.4 </x>
        <y> 0.65 </y>
        <z> 0.4 </z>
      </location>
      <capacity unit="KG"> 295 </capacity>
      <contents unit="KG"> 0 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Left Minor Wing Tank 5V -->
      <location unit="M">
        <x> 1.25 </x>
        <y> -1.45 </y>
        <z> -0.55 </z>
      </location>
      <capacity unit="KG"> 200 </capacity>
      <contents unit="KG"> 0 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Right Minor Wing Tank 5H -->
      <location unit="M">
        <x> 1.25 </x>
        <y> 1.45</y>
        <z> -0.55 </z>
      </location>
      <capacity unit="KG"> 200 </capacity>
      <contents unit="KG"> 0 </contents>
    </tank>
    <tank type="FUEL">
      <!-- left wing tank 4V -->
      <location unit="M">
        <x> 3.3 </x>
        <y> -2 </y>
        <z> -0.55 </z>
      </location>
      <capacity unit="KG"> 880 </capacity>
      <contents unit="KG"> 880 </contents>
    </tank>
    <tank type="FUEL">
      <!-- Right wing tank 4H -->
      <location unit="M">
        <x> 3.3 </x>
        <y> 2 </y>
        <z> -0.55 </z>
      </location>
      <capacity unit="KG"> 880 </capacity>
      <contents unit="KG"> 880 </contents>
    </tank>
  </propulsion>
    
  <flight_control name="JA37 FC">

    <channel name="Elevons">
      <summer name="Pitch Trim Sum">
          <input>fcs/elevator-cmd-norm</input>
          <input>fcs/pitch-trim-cmd-norm</input>
          <clipto>
              <min>-1</min>
              <max>1</max>
          </clipto>
          <output>fcs/pitch-trim-sum</output>
      </summer>

      <aerosurface_scale name="Elevator Control">
          <input>fcs/pitch-trim-sum</input>
          <range>
              <min>-0.35</min>
              <max>0.3</max>
          </range>
          <output>fcs/elevator-pos-rad</output>
      </aerosurface_scale>

      <summer name="Roll Trim Sum">
          <input>fcs/aileron-cmd-norm</input>
          <input>fcs/roll-trim-cmd-norm</input>
          <clipto>
              <min>-1</min>
              <max>1</max>
          </clipto>
          <output>fcs/roll-trim-sum</output>
      </summer>

      <aerosurface_scale name="Left Aileron Control">
          <input>fcs/roll-trim-sum</input>
          <range>
              <min>-0.35</min>
              <max>0.35</max>
          </range>
          <output>fcs/left-aileron-pos-rad</output>
      </aerosurface_scale>

      <aerosurface_scale name="Right Aileron Control">
          <input>-fcs/roll-trim-sum</input>
          <range>
              <min>-0.35</min>
              <max>0.35</max>
          </range>
          <output>fcs/right-aileron-pos-rad</output>
      </aerosurface_scale>

      <summer name="Left Elevon Pos Rad">
         <input>fcs/left-aileron-pos-rad</input>
         <input>fcs/elevator-pos-rad</input>
         <clipto>
           <min> -0.35 </min>
           <max>  0.35 </max>
         </clipto>
         <output>fcs/left-elevon-pos-rad</output>
      </summer>

      <summer name="Right Elevon Pos Rad">
         <input>fcs/right-aileron-pos-rad</input>
         <input>fcs/elevator-pos-rad</input>
         <clipto>
           <min> -0.35 </min>
           <max>  0.35 </max>
         </clipto>
         <output>fcs/right-elevon-pos-rad</output>
      </summer> 

      <pure_gain name="Left Elevon Pos Deg">
          <input>fcs/left-elevon-pos-rad</input>
          <gain>57.3</gain>
          <output>/surface-positions/left-elevon-pos-deg</output>
      </pure_gain>

      <pure_gain name="Right Elevon Pos Deg">
          <input>fcs/right-elevon-pos-rad</input>
          <gain>57.3</gain>
          <output>/surface-positions/right-elevon-pos-deg</output>
      </pure_gain>

    </channel>

    <channel name="Yaw">
      <summer name="Rudder Command Sum">
        <input>fcs/rudder-cmd-norm</input>
        <input>fcs/yaw-trim-cmd-norm</input>
        <clipto>
          <min> -0.3 </min>
          <max>  0.3 </max>
        </clipto>
      </summer>
      <scheduled_gain name="Yaw Damper Rate">
        <input>velocities/r-aero-rad_sec</input>
        <table>
          <independentVar lookup="row">velocities/ve-kts</independentVar>
          <tableData>
            30     0.00
            60     2.00
         </tableData>
        </table>
        <gain>1</gain>         <!-- yaw damper enabled -->
        <output>fcs/yaw-damper-rate</output>
      </scheduled_gain>
      <summer name="Rudder Sum">
        <input>fcs/rudder-command-sum</input>
        <input>fcs/yaw-damper-rate</input>
        <clipto>
          <min> -1.1 </min>
          <max>  1.1 </max>
        </clipto>
      </summer>
      <aerosurface_scale name="Rudder Control">
        <input>fcs/rudder-sum</input>
        <domain>
          <min> -1.1 </min>
          <max>  1.1 </max>
        </domain>
        <range>
          <min> -0.35 </min>
          <max>  0.35 </max>
        </range>
        <output>fcs/rudder-pos-rad</output>
      </aerosurface_scale>
      <aerosurface_scale name="rudder normalization">
        <input>fcs/rudder-pos-rad</input>
        <domain>
          <min> -0.35 </min>
          <max>  0.35 </max>
        </domain>
        <range>
          <min> -1 </min>
          <max>  1 </max>
        </range>
        <output>fcs/rudder-pos-norm</output>
      </aerosurface_scale>
    </channel>
    <channel name="Landing Gear">
      <switch name="fcs/gear-wow">
        <default value="0"/>
        <test logic="AND" value="1">

                    gear/unit[1]/WOW eq 1

                    gear/unit[2]/WOW eq 1

                </test>
      </switch>
      <kinematic name="fcs/gear-control">
        <input>gear/gear-cmd-norm</input>
        <traverse>
          <setting>
            <position>0</position>
            <time>0</time>
          </setting>
          <setting>
            <position>1</position>
            <time>5</time>
          </setting>
        </traverse>
        <output>gear/gear-pos-norm</output>
      </kinematic>
      <scheduled_gain name="fcs/scheduled-steer-pos-deg">
        <input>fcs/steer-cmd-norm</input>
        <table>
          <independentVar>velocities/vg-fps</independentVar>
          <tableData>
              10.0        80.0
              50.0        15.0
              150.0       2.0
          </tableData>
        </table>
        <output>fcs/steer-pos-deg</output>
      </scheduled_gain>
    </channel>

    <channel name="Flaps">
      <kinematic name="Flaps Control">
        <input>gear/gear-cmd-norm</input><!-- flaps controlled by gear-->
        <traverse>
          <setting>
            <position>  0 </position>
            <time>      0 </time>
          </setting>
          <setting>
            <position> 50 </position>
            <time>      3 </time>
          </setting>
        </traverse>
        <output>fcs/flap-pos-deg</output>
      </kinematic>

      <aerosurface_scale name="flap normalization">
        <input>fcs/flap-pos-deg</input>
        <domain>
          <min>  0 </min>
          <max> 50 </max>
        </domain>
        <range>
          <min> 0 </min>
          <max> 1 </max>
        </range>
        <output>fcs/flap-pos-norm</output>
      </aerosurface_scale>
    </channel>

    <channel name="Throttle">
      <pure_gain name="fcs/throttle1">
        <input>fcs/throttle-cmd-norm</input>
        <gain>2</gain>
        <output>fcs/throttle-pos-norm</output>
      </pure_gain>
    </channel>
    <channel name="Speedbrake">
      <!--

              - To prevent deep stall the Flight Computer commands speedbrake

              - deflection at high angle of attack (alpha) and low speeds. This

              - will provide just enough pitch down moment to keep the aircraft

              - under control.

              -->
      <switch name="fcs/speedbrake-alpha-limiter">
        <default value="0"/>
        <test logic="AND" value="1">

                    aero/alpha-deg ge 53 

                    velocities/v-fps le 18

                </test>
      </switch>
      <switch name="fcs/speedbrake-initiate">
        <default value="0"/>
        <test logic="OR" value="1">

                    fcs/speedbrake-alpha-limiter eq 1

                    fcs/speedbrake-cmd-norm eq 1

                </test>
      </switch>
      <!--

              - Speedbrake deflection is limited to 43 degrees (instead of 60

              - degrees) when the gear is extended to prevent physical

              - speedbrake damage on touchdown.

              -->
      <scheduled_gain name="fcs/speedbrake-scheduler">
        <input>fcs/speedbrake-initiate</input>
        <table>
          <independentVar>gear/gear-cmd-norm</independentVar>
          <tableData>
              0    1.0
              1    0.71667
          </tableData>
        </table>
        <output>fcs/speedbrake-pos-limit</output>
      </scheduled_gain>
      <kinematic name="fcs/speedbrake-control">
        <input>fcs/speedbrake-scheduler</input>
        <traverse>
          <setting>
            <position>0</position>
            <time>0</time>
          </setting>
          <setting>
            <position>60</position>
            <time>1</time>
          </setting>
        </traverse>
        <output>fcs/speedbrake-pos-deg</output>
      </kinematic>
      <aerosurface_scale name="fcs/speedbrake-position-normalizer">
        <input>fcs/speedbrake-control</input>
        <domain>
          <min>0</min>
          <max>60</max>
        </domain>
        <range>
          <min>0</min>
          <max>1</max>
        </range>
        <output>fcs/speedbrake-pos-norm</output>
      </aerosurface_scale>
    </channel>
    
  </flight_control>
  
  <aerodynamics file="datcom_aero.xml"/>
  
</fdm_config>
